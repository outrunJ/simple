{"version":3,"sources":["gaze.js"],"names":[],"mappings":"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","file":"gaze-compiled.js","sourcesContent":["/*\n * gaze\n * https://github.com/shama/gaze\n *\n * Copyright (c) 2013 Kyle Robinson Young\n * Licensed under the MIT license.\n */\n\n'use strict';\n\n// libs\nvar util = require('util');\nvar EE = require('events').EventEmitter;\nvar fs = require('fs');\nvar path = require('path');\nvar globule = require('globule');\nvar helper = require('./helper');\n\n// shim setImmediate for node v0.8\nvar setImmediate = require('timers').setImmediate;\nif (typeof setImmediate !== 'function') {\n  setImmediate = process.nextTick;\n}\n\n// globals\nvar delay = 10;\n\n// `Gaze` EventEmitter object to return in the callback\nfunction Gaze(patterns, opts, done) {\n  var self = this;\n  EE.call(self);\n\n  // If second arg is the callback\n  if (typeof opts === 'function') {\n    done = opts;\n    opts = {};\n  }\n\n  // Default options\n  opts = opts || {};\n  opts.mark = true;\n  opts.interval = opts.interval || 100;\n  opts.debounceDelay = opts.debounceDelay || 500;\n  opts.cwd = opts.cwd || process.cwd();\n  this.options = opts;\n\n  // Default done callback\n  done = done || function() {};\n\n  // Remember our watched dir:files\n  this._watched = Object.create(null);\n\n  // Store watchers\n  this._watchers = Object.create(null);\n\n  // Store watchFile listeners\n  this._pollers = Object.create(null);\n\n  // Store patterns\n  this._patterns = [];\n\n  // Cached events for debouncing\n  this._cached = Object.create(null);\n\n  // Set maxListeners\n  if (this.options.maxListeners) {\n    this.setMaxListeners(this.options.maxListeners);\n    Gaze.super_.prototype.setMaxListeners(this.options.maxListeners);\n    delete this.options.maxListeners;\n  }\n\n  // Initialize the watch on files\n  if (patterns) {\n    this.add(patterns, done);\n  }\n\n  // keep the process alive\n  this._keepalive = setInterval(function() {}, 200);\n\n  return this;\n}\nutil.inherits(Gaze, EE);\n\n// Main entry point. Start watching and call done when setup\nmodule.exports = function gaze(patterns, opts, done) {\n  return new Gaze(patterns, opts, done);\n};\nmodule.exports.Gaze = Gaze;\n\n// Override the emit function to emit `all` events\n// and debounce on duplicate events per file\nGaze.prototype.emit = function() {\n  var self = this;\n  var args = arguments;\n\n  var e = args[0];\n  var filepath = args[1];\n  var timeoutId;\n\n  // If not added/deleted/changed/renamed then just emit the event\n  if (e.slice(-2) !== 'ed') {\n    Gaze.super_.prototype.emit.apply(self, args);\n    return this;\n  }\n\n  // Detect rename event, if added and previous deleted is in the cache\n  if (e === 'added') {\n    Object.keys(this._cached).forEach(function(oldFile) {\n      if (self._cached[oldFile].indexOf('deleted') !== -1) {\n        args[0] = e = 'renamed';\n        [].push.call(args, oldFile);\n        delete self._cached[oldFile];\n        return false;\n      }\n    });\n  }\n\n  // If cached doesnt exist, create a delay before running the next\n  // then emit the event\n  var cache = this._cached[filepath] || [];\n  if (cache.indexOf(e) === -1) {\n    helper.objectPush(self._cached, filepath, e);\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(function() {\n      delete self._cached[filepath];\n    }, this.options.debounceDelay);\n    // Emit the event and `all` event\n    Gaze.super_.prototype.emit.apply(self, args);\n    Gaze.super_.prototype.emit.apply(self, ['all', e].concat([].slice.call(args, 1)));\n  }\n\n  // Detect if new folder added to trigger for matching files within folder\n  if (e === 'added') {\n    if (helper.isDir(filepath)) {\n      fs.readdirSync(filepath).map(function(file) {\n        return path.join(filepath, file);\n      }).filter(function(file) {\n        return globule.isMatch(self._patterns, file, self.options);\n      }).forEach(function(file) {\n        self.emit('added', file);\n      });\n    }\n  }\n\n  return this;\n};\n\n// Close watchers\nGaze.prototype.close = function(_reset) {\n  var self = this;\n  _reset = _reset === false ? false : true;\n  Object.keys(self._watchers).forEach(function(file) {\n    self._watchers[file].close();\n  });\n  self._watchers = Object.create(null);\n  Object.keys(this._watched).forEach(function(dir) {\n    self._unpollDir(dir);\n  });\n  if (_reset) {\n    self._watched = Object.create(null);\n    setTimeout(function() {\n      self.emit('end');\n      self.removeAllListeners();\n      clearInterval(self._keepalive);\n    }, delay + 100);\n  }\n  return self;\n};\n\n// Add file patterns to be watched\nGaze.prototype.add = function(files, done) {\n  if (typeof files === 'string') { files = [files]; }\n  this._patterns = helper.unique.apply(null, [this._patterns, files]);\n  files = globule.find(this._patterns, this.options);\n  this._addToWatched(files);\n  this.close(false);\n  this._initWatched(done);\n};\n\n// Dont increment patterns and dont call done if nothing added\nGaze.prototype._internalAdd = function(file, done) {\n  var files = [];\n  if (helper.isDir(file)) {\n    files = [helper.markDir(file)].concat(globule.find(this._patterns, this.options));\n  } else {\n    if (globule.isMatch(this._patterns, file, this.options)) {\n      files = [file];\n    }\n  }\n  if (files.length > 0) {\n    this._addToWatched(files);\n    this.close(false);\n    this._initWatched(done);\n  }\n};\n\n// Remove file/dir from `watched`\nGaze.prototype.remove = function(file) {\n  var self = this;\n  if (this._watched[file]) {\n    // is dir, remove all files\n    this._unpollDir(file);\n    delete this._watched[file];\n  } else {\n    // is a file, find and remove\n    Object.keys(this._watched).forEach(function(dir) {\n      var index = self._watched[dir].indexOf(file);\n      if (index !== -1) {\n        self._unpollFile(file);\n        self._watched[dir].splice(index, 1);\n        return false;\n      }\n    });\n  }\n  if (this._watchers[file]) {\n    this._watchers[file].close();\n  }\n  return this;\n};\n\n// Return watched files\nGaze.prototype.watched = function() {\n  return this._watched;\n};\n\n// Returns `watched` files with relative paths to process.cwd()\nGaze.prototype.relative = function(dir, unixify) {\n  var self = this;\n  var relative = Object.create(null);\n  var relDir, relFile, unixRelDir;\n  var cwd = this.options.cwd || process.cwd();\n  if (dir === '') { dir = '.'; }\n  dir = helper.markDir(dir);\n  unixify = unixify || false;\n  Object.keys(this._watched).forEach(function(dir) {\n    relDir = path.relative(cwd, dir) + path.sep;\n    if (relDir === path.sep) { relDir = '.'; }\n    unixRelDir = unixify ? helper.unixifyPathSep(relDir) : relDir;\n    relative[unixRelDir] = self._watched[dir].map(function(file) {\n      relFile = path.relative(path.join(cwd, relDir) || '', file || '');\n      if (helper.isDir(file)) {\n        relFile = helper.markDir(relFile);\n      }\n      if (unixify) {\n        relFile = helper.unixifyPathSep(relFile);\n      }\n      return relFile;\n    });\n  });\n  if (dir && unixify) {\n    dir = helper.unixifyPathSep(dir);\n  }\n  return dir ? relative[dir] || [] : relative;\n};\n\n// Adds files and dirs to watched\nGaze.prototype._addToWatched = function(files) {\n  for (var i = 0; i < files.length; i++) {\n    var file = files[i];\n    var filepath = path.resolve(this.options.cwd, file);\n\n    var dirname = (helper.isDir(file)) ? filepath : path.dirname(filepath);\n    dirname = helper.markDir(dirname);\n\n    // If a new dir is added\n    if (helper.isDir(file) && !(filepath in this._watched)) {\n      helper.objectPush(this._watched, filepath, []);\n    }\n\n    if (file.slice(-1) === '/') { filepath += path.sep; }\n    helper.objectPush(this._watched, path.dirname(filepath) + path.sep, filepath);\n\n    // add folders into the mix\n    var readdir = fs.readdirSync(dirname);\n    for (var j = 0; j < readdir.length; j++) {\n      var dirfile = path.join(dirname, readdir[j]);\n      if (fs.lstatSync(dirfile).isDirectory()) {\n        helper.objectPush(this._watched, dirname, dirfile + path.sep);\n      }\n    }\n  }\n  return this;\n};\n\nGaze.prototype._watchDir = function(dir, done) {\n  var self = this;\n  var timeoutId;\n  try {\n    this._watchers[dir] = fs.watch(dir, function(event) {\n      // race condition. Let's give the fs a little time to settle down. so we\n      // don't fire events on non existent files.\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(function() {\n        // race condition. Ensure that this directory is still being watched\n        // before continuing.\n        if ((dir in self._watchers) && fs.existsSync(dir)) {\n          done(null, dir);\n        }\n      }, delay + 100);\n    });\n  } catch (err) {\n    return this._handleError(err);\n  }\n  return this;\n};\n\nGaze.prototype._unpollFile = function(file) {\n  if (this._pollers[file]) {\n    fs.unwatchFile(file, this._pollers[file] );\n    delete this._pollers[file];\n  }\n  return this;\n};\n\nGaze.prototype._unpollDir = function(dir) {\n  this._unpollFile(dir);\n  for (var i = 0; i < this._watched[dir].length; i++) {\n    this._unpollFile(this._watched[dir][i]);\n  }\n};\n\nGaze.prototype._pollFile = function(file, done) {\n  var opts = { persistent: true, interval: this.options.interval };\n  if (!this._pollers[file]) {\n    this._pollers[file] = function(curr, prev) {\n      done(null, file);\n    };\n    try {\n      fs.watchFile(file, opts, this._pollers[file]);\n    } catch (err) {\n      return this._handleError(err);\n    }\n  }\n  return this;\n};\n\n// Initialize the actual watch on `watched` files\nGaze.prototype._initWatched = function(done) {\n  var self = this;\n  var cwd = this.options.cwd || process.cwd();\n  var curWatched = Object.keys(self._watched);\n\n  // if no matching files\n  if (curWatched.length < 1) {\n    // Defer to emitting to give a chance to attach event handlers.\n    setImmediate(function () {\n      self.emit('ready', self);\n      if (done) { done.call(self, null, self); }\n      self.emit('nomatch');\n    });\n    return;\n  }\n\n  helper.forEachSeries(curWatched, function(dir, next) {\n    dir = dir || '';\n    var files = self._watched[dir];\n    // Triggered when a watched dir has an event\n    self._watchDir(dir, function(event, dirpath) {\n      var relDir = cwd === dir ? '.' : path.relative(cwd, dir);\n      relDir = relDir || '';\n\n      fs.readdir(dirpath, function(err, current) {\n        if (err) { return self.emit('error', err); }\n        if (!current) { return; }\n\n        try {\n          // append path.sep to directories so they match previous.\n          current = current.map(function(curPath) {\n            if (fs.existsSync(path.join(dir, curPath)) && fs.lstatSync(path.join(dir, curPath)).isDirectory()) {\n              return curPath + path.sep;\n            } else {\n              return curPath;\n            }\n          });\n        } catch (err) {\n          // race condition-- sometimes the file no longer exists\n        }\n\n        // Get watched files for this dir\n        var previous = self.relative(relDir);\n\n        // If file was deleted\n        previous.filter(function(file) {\n          return current.indexOf(file) < 0;\n        }).forEach(function(file) {\n          if (!helper.isDir(file)) {\n            var filepath = path.join(dir, file);\n            self.remove(filepath);\n            self.emit('deleted', filepath);\n          }\n        });\n\n        // If file was added\n        current.filter(function(file) {\n          return previous.indexOf(file) < 0;\n        }).forEach(function(file) {\n          // Is it a matching pattern?\n          var relFile = path.join(relDir, file);\n          // Add to watch then emit event\n          self._internalAdd(relFile, function() {\n            self.emit('added', path.join(dir, file));\n          });\n        });\n\n      });\n    });\n\n    // Watch for change/rename events on files\n    files.forEach(function(file) {\n      if (helper.isDir(file)) { return; }\n      self._pollFile(file, function(err, filepath) {\n        // Only emit changed if the file still exists\n        // Prevents changed/deleted duplicate events\n        if (fs.existsSync(filepath)) {\n          self.emit('changed', filepath);\n        }\n      });\n    });\n\n    next();\n  }, function() {\n\n    // Return this instance of Gaze\n    // delay before ready solves a lot of issues\n    setTimeout(function() {\n      self.emit('ready', self);\n      if (done) { done.call(self, null, self); }\n    }, delay + 100);\n\n  });\n};\n\n// If an error, handle it here\nGaze.prototype._handleError = function(err) {\n  if (err.code === 'EMFILE') {\n    return this.emit('error', new Error('EMFILE: Too many opened files.'));\n  }\n  return this.emit('error', err);\n};\n"]}