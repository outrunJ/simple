{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var expect = require('chai').expect\n  , unique = require('..')\n  , Stream = require('stream')\n  , after = require('after')\n  , setImmediate = global.setImmediate || process.nextTick;\n\ndescribe('unique stream', function() {\n\n  function makeStream(type) {\n    var s = new Stream();\n    s.readable = true;\n\n    var n = 10;\n    var next = after(n, function () {\n      setImmediate(function () {\n        s.emit('end');\n      });\n    });\n\n    for (var i = 0; i < n; i++) {\n      var o = {\n        type: type,\n        name: 'name ' + i,\n        number: i * 10\n      };\n\n      (function (o) {\n        setImmediate(function () {\n          s.emit('data', o);\n          next();\n        });\n      })(o);\n    }\n    return s;\n  }\n\n  it('should be able to uniqueify objects based on JSON data', function(done) {\n    var aggregator = unique();\n    makeStream('a')\n      .pipe(aggregator);\n    makeStream('a')\n      .pipe(aggregator);\n\n    var n = 0;\n    aggregator\n      .on('data', function () {\n        n++;\n      })\n      .on('end', function () {\n        expect(n).to.equal(10);\n        done();\n      });\n  });\n\n  it('should be able to uniqueify objects based on a property', function(done) {\n    var aggregator = unique('number');\n    makeStream('a')\n      .pipe(aggregator);\n    makeStream('b')\n      .pipe(aggregator);\n\n    var n = 0;\n    aggregator\n      .on('data', function () {\n        n++;\n      })\n      .on('end', function () {\n        expect(n).to.equal(10);\n        done();\n      });\n  });\n\n  it('should be able to uniqueify objects based on a function', function(done) {\n    var aggregator = unique(function (data) {\n      return data.name;\n    });\n\n    makeStream('a')\n      .pipe(aggregator);\n    makeStream('b')\n      .pipe(aggregator);\n\n    var n = 0;\n    aggregator\n      .on('data', function () {\n        n++;\n      })\n      .on('end', function () {\n        expect(n).to.equal(10);\n        done();\n      });\n  });\n\n  it('should be able to handle uniqueness when not piped', function(done) {\n    var stream = unique();\n    var count = 0;\n    stream.on('data', function (data) {\n      expect(data).to.equal('hello');\n      count++;\n    });\n    stream.on('end', function() {\n      expect(count).to.equal(1);\n      done();\n    });\n    stream.write('hello');\n    stream.write('hello');\n    stream.end();\n  });\n});\n"]}