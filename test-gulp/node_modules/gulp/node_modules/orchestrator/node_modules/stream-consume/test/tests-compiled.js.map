{"version":3,"sources":["tests.js"],"names":[],"mappings":"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","file":"tests-compiled.js","sourcesContent":["/*jshint node:true */\n/*global describe:false, it:false */\n\"use strict\";\n\nvar consume = require('../');\nvar Stream = require('stream');\nvar Readable = Stream.Readable;\nvar Writable = Stream.Writable;\nvar Duplex = Stream.Duplex;\nvar should = require('should');\nvar through = require('through2');\nrequire('mocha');\n\ndescribe('stream-consume', function() {\n\n    it('should cause a Readable stream to complete if it\\'s not piped anywhere', function(done) {\n        var rs = new Readable({highWaterMark: 2});\n        var a = 0;\n        var ended = false;\n        rs._read = function() {\n            if (a++ < 100) {\n                rs.push(a + \"\");\n            } else {\n                ended = true;\n                rs.push(null);\n            }\n        };\n\n        rs.on(\"end\", function() {\n            a.should.be.above(99);\n            ended.should.be.true;\n            done();\n        });\n\n        consume(rs);\n    });\n\n    it('should work with Readable streams in objectMode', function(done) {\n        var rs = new Readable({highWaterMark: 2, objectMode: true});\n        var a = 0;\n        var ended = false;\n        rs._read = function() {\n            if (a++ < 100) {\n                rs.push(a);\n            } else {\n                ended = true;\n                rs.push(null);\n            }\n        };\n\n        rs.on(\"end\", function() {\n            a.should.be.above(99);\n            ended.should.be.true;\n            done();\n        });\n\n        consume(rs);\n    });\n\n    it('should not interfere with a Readable stream that is piped somewhere', function(done) {\n        var rs = new Readable({highWaterMark: 2});\n        var a = 0;\n        var ended = false;\n        rs._read = function() {\n            if (a++ < 100) {\n                rs.push(\".\");\n            } else {\n                ended = true;\n                rs.push(null);\n            }\n        };\n\n        var sizeRead = 0;\n        var ws = new Writable({highWaterMark: 2});\n        ws._write = function(chunk, enc, next) {\n            sizeRead += chunk.length;\n            next();\n        }\n\n        ws.on(\"finish\", function() {\n            a.should.be.above(99);\n            ended.should.be.true;\n            sizeRead.should.equal(100);\n            done();\n        });\n\n        rs.pipe(ws);\n\n        consume(rs);\n    });\n\n    it('should not interfere with a Writable stream', function(done) {\n        var rs = new Readable({highWaterMark: 2});\n        var a = 0;\n        var ended = false;\n        rs._read = function() {\n            if (a++ < 100) {\n                rs.push(\".\");\n            } else {\n                ended = true;\n                rs.push(null);\n            }\n        };\n\n        var sizeRead = 0;\n        var ws = new Writable({highWaterMark: 2});\n        ws._write = function(chunk, enc, next) {\n            sizeRead += chunk.length;\n            next();\n        }\n\n        ws.on(\"finish\", function() {\n            a.should.be.above(99);\n            ended.should.be.true;\n            sizeRead.should.equal(100);\n            done();\n        });\n\n        rs.pipe(ws);\n\n        consume(ws);\n    });\n\n    it('should handle a Transform stream', function(done) {\n        var rs = new Readable({highWaterMark: 2});\n        var a = 0;\n        var ended = false;\n        rs._read = function() {\n            if (a++ < 100) {\n                rs.push(\".\");\n            } else {\n                ended = true;\n                rs.push(null);\n            }\n        };\n\n        var sizeRead = 0;\n        var flushed = false;\n        var ts = through({highWaterMark: 2}, function(chunk, enc, cb) {\n            sizeRead += chunk.length;\n            this.push(chunk);\n            cb();\n        }, function(cb) {\n            flushed = true;\n            cb();\n        });\n\n        ts.on(\"end\", function() {\n            a.should.be.above(99);\n            ended.should.be.true;\n            sizeRead.should.equal(100);\n            flushed.should.be.true;\n            done();\n        });\n\n        rs.pipe(ts);\n\n        consume(ts);\n    });\n\n    it('should handle a classic stream', function(done) {\n        var rs = new Stream();\n        var ended = false;\n        var i;\n\n        rs.on(\"end\", function() {\n            ended.should.be.true;\n            done();\n        });\n\n        consume(rs);\n\n        for (i = 0; i < 100; i++) {\n            rs.emit(\"data\", i);\n        }\n        ended = true;\n        rs.emit(\"end\");\n    });\n\n});\n"]}