{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var once = require('once');\n\nvar noop = function() {};\n\nvar isRequest = function(stream) {\n\treturn stream.setHeader && typeof stream.abort === 'function';\n};\n\nvar eos = function(stream, opts, callback) {\n\tif (typeof opts === 'function') return eos(stream, null, opts);\n\tif (!opts) opts = {};\n\n\tcallback = once(callback || noop);\n\n\tvar ws = stream._writableState;\n\tvar rs = stream._readableState;\n\tvar readable = opts.readable || (opts.readable !== false && stream.readable);\n\tvar writable = opts.writable || (opts.writable !== false && stream.writable);\n\n\tvar onlegacyfinish = function() {\n\t\tif (!stream.writable) onfinish();\n\t};\n\n\tvar onfinish = function() {\n\t\twritable = false;\n\t\tif (!readable) callback();\n\t};\n\n\tvar onend = function() {\n\t\treadable = false;\n\t\tif (!writable) callback();\n\t};\n\n\tvar onclose = function() {\n\t\tif (readable && !(rs && rs.ended)) return callback(new Error('premature close'));\n\t\tif (writable && !(ws && ws.ended)) return callback(new Error('premature close'));\n\t};\n\n\tvar onrequest = function() {\n\t\tstream.req.on('finish', onfinish);\n\t};\n\n\tif (isRequest(stream)) {\n\t\tstream.on('complete', onfinish);\n\t\tstream.on('abort', onclose);\n\t\tif (stream.req) onrequest();\n\t\telse stream.on('request', onrequest);\n\t} else if (writable && !ws) { // legacy streams\n\t\tstream.on('end', onlegacyfinish);\n\t\tstream.on('close', onlegacyfinish);\n\t}\n\n\tstream.on('end', onend);\n\tstream.on('finish', onfinish);\n\tif (opts.error !== false) stream.on('error', callback);\n\tstream.on('close', onclose);\n\n\treturn stream;\n};\n\nmodule.exports = eos;"]}